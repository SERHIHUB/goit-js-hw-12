{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst fetchBtn = document.querySelector('.btn');\nconst loadBtn = document.querySelector('.load-btn');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.spinner');\n\nconst newGallery = new SimpleLightbox('.gallery a');\n\nconst API_KEY = '41458722-788aa599ff2a579d31eb49587';\n\nlet searchQuery;\nlet page;\nlet totalItems;\nlet totalPages;\nconst limit = 40;\n\nconst url = new URL('https://pixabay.com/api/');\nurl.searchParams.append('key', `${API_KEY}`);\nurl.searchParams.append('image_type', 'photo');\nurl.searchParams.append('orientation', 'horizontal');\nurl.searchParams.append('safesearch', 'true');\nurl.searchParams.append('per_page', limit);\n\ninput.addEventListener('input', event => {\n  searchQuery = event.target.value;\n});\n\nconst fetchPhotos = async () => {\n  const photos = await axios.get(url);\n\n  return photos.data;\n};\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n  loader.classList.add('loader');\n  page = 1;\n  gallery.innerHTML = '';\n\n  url.searchParams.delete('q');\n  url.searchParams.append('q', searchQuery);\n  url.searchParams.delete('page');\n  url.searchParams.append('page', page);\n\n  fetchPhotos()\n    .then(response => {\n      if (response.total === 0) {\n        loadBtn.style.display = 'none';\n        iziError();\n      }\n      totalItems = response.totalHits;\n      totalPages = Math.ceil(totalItems / limit);\n      renderPhotos(response.hits);\n      if (response.total !== 0) {\n        loadBtn.style.display = 'block';\n      }\n      newGallery.refresh();\n      if (page >= totalPages) {\n        loadBtn.style.display = 'none';\n        iziToast.info({\n          message: `We're sorry, but you've reached the end of search results.`,\n          position: 'topRight',\n        });\n      }\n    })\n    .catch(error => {\n      showMessage();\n    })\n    .finally(() => {\n      form.reset();\n      loader.classList.remove('loader');\n    });\n});\n\nloadBtn.addEventListener('click', event => {\n  event.preventDefault();\n\n  page += 1;\n\n  url.searchParams.delete('q');\n  url.searchParams.append('q', searchQuery);\n  url.searchParams.delete('page');\n  url.searchParams.append('page', page);\n\n  fetchPhotos()\n    .then(response => {\n      if (page >= totalPages) {\n        loadBtn.style.display = 'none';\n        iziToast.info({\n          message: `We're sorry, but you've reached the end of search results.`,\n          position: 'topRight',\n        });\n      }\n      renderPhotos(response.hits);\n      newGallery.refresh();\n      window.scrollBy({\n        top: 540,\n        behavior: 'smooth',\n      });\n    })\n    .catch(error => {\n      showMessage();\n    })\n    .finally(() => {\n      form.reset();\n      loader.classList.remove('loader');\n    });\n});\n\nfunction renderPhotos(arr) {\n  gallery.insertAdjacentHTML(\n    'beforeend',\n    arr.reduce(\n      (\n        html,\n        { largeImageURL, webformatURL, likes, views, comments, downloads }\n      ) =>\n        html +\n        `<li class=\"gallery-item\">\n          <a href=\"${largeImageURL}\">\n            <div class=\"pic-item\">\n              <img src=\"${webformatURL}\" alt=\"photo\">\n            </div>\n            <ul class=\"information-list\">\n              <li class=\"information-item\">likes<br>${likes}</li>\n              <li class=\"information-item\">views<br>${views}</li>\n              <li class=\"information-item\">comments<br>${comments}</li>\n              <li class=\"information-item\">downloads<br>${downloads}</li>\n            </ul>\n          </a>\n        </li>`,\n      ''\n    )\n  );\n}\n\nfunction showMessage() {\n  iziToast.error({\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n}\n"],"names":["form","input","loadBtn","gallery","loader","newGallery","SimpleLightbox","API_KEY","searchQuery","page","totalItems","totalPages","limit","url","event","fetchPhotos","axios","response","renderPhotos","iziToast","error","showMessage","arr","html","largeImageURL","webformatURL","likes","views","comments","downloads"],"mappings":"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"}